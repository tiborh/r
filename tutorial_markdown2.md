Introduction to R Markdown 2
================
`tibor`
`2016-07-09`

Data
----

The `atmos` data set resides in the `nasaweather` package of the *R* programming language. It contains a collection of atmospheric variables measured between 1995 and 2000 on a grid of 576 coordinates in the western hemisphere. The data set comes from the [2006 ASA Data Expo](http://stat-computing.org/dataexpo/2006/).

Some of the variables in the `atmos` data set are:

-   **temp** - The mean monthly air temperature near the surface of the Earth (measured in degrees kelvin (*K*))
-   **pressure** - The mean monthly air pressure at the surface of the Earth (measured in millibars (*mb*))
-   **ozone** - The mean monthly abundance of atmospheric ozone (measured in Dobson units (*DU*))

You can convert the temperature unit from Kelvin to Celsius with the formula

\[ celsius = kelvin - 273.15 \]

And you can convert the result to Fahrenheit with the formula

\[ fahrenheit = celsius \times \frac{5}{9} + 32 \]

Backwards:

\[ celsius =  (fahrenheit - 32) \times \frac{9}{5} \]

Reformat Data with dplyr
------------------------

``` r
year <- 1995

means <- atmos %>% 
  filter(year == year) %>%
  group_by(long, lat) %>%
  summarize(temp = mean(temp, na.rm = TRUE), 
         pressure = mean(pressure, na.rm = TRUE),
         ozone = mean(ozone, na.rm = TRUE),
         cloudlow = mean(cloudlow, na.rm = TRUE),
         cloudmid = mean(cloudmid, na.rm = TRUE),
         cloudhigh = mean(cloudhigh, na.rm = TRUE)) %>%
  ungroup()

print(means)
```

    ## # A tibble: 561 x 8
    ##      long        lat     temp pressure    ozone cloudlow   cloudmid
    ##     <dbl>      <dbl>    <dbl>    <dbl>    <dbl>    <dbl>      <dbl>
    ## 1  -113.8 -21.200000 296.1333     1000 269.3333 36.16667  6.3333333
    ## 2  -113.8 -18.704348 295.7250     1000 268.5000 38.25000  3.0000000
    ## 3  -113.8 -16.208696 298.0500     1000 248.0000 36.50000  2.2500000
    ## 4  -113.8 -13.713043 296.0000     1000 265.0000 36.00000  1.2500000
    ## 5  -113.8 -11.217391 296.8800     1000 260.8000 35.00000  1.1000000
    ## 6  -113.8  -8.721739 296.9000     1000 262.0000 30.12500  1.7500000
    ## 7  -113.8  -6.226087 299.5000     1000 250.6667 28.50000  5.5000000
    ## 8  -113.8  -3.730435 298.4333     1000 254.6667 18.50000  0.8333333
    ## 9  -113.8  -1.234783 301.0000     1000 232.0000 29.00000 24.0000000
    ## 10 -113.8   1.260870 296.9333     1000 256.0000 43.33333  5.8333333
    ## # ... with 551 more rows, and 1 more variables: cloudhigh <dbl>

Plot pressure vs ozone (ggvis)
------------------------------

``` r
means %>% 
  ggvis(x = ~pressure, y = ~ozone) %>%
  layer_points()
```

<!--html_preserve-->

<nav class="ggvis-control"> <a class="ggvis-dropdown-toggle" title="Controls" onclick="return false;"></a>
<ul class="ggvis-dropdown">
<li>
Renderer: <a id="plot_id893835749_renderer_svg" class="ggvis-renderer-button" onclick="return false;" data-plot-id="plot_id893835749" data-renderer="svg">SVG</a> | <a id="plot_id893835749_renderer_canvas" class="ggvis-renderer-button" onclick="return false;" data-plot-id="plot_id893835749" data-renderer="canvas">Canvas</a>
</li>
<li>
<a id="plot_id893835749_download" class="ggvis-download" data-plot-id="plot_id893835749">Download</a>
</li>
</ul>
</nav>

<script type="text/javascript">
var plot_id893835749_spec = {
  "data": [
    {
      "name": ".0",
      "format": {
        "type": "csv",
        "parse": {
          "pressure": "number",
          "ozone": "number"
        }
      },
      "values": "\"pressure\",\"ozone\"\n1000,269.333333333333\n1000,268.5\n1000,248\n1000,265\n1000,260.8\n1000,262\n1000,250.666666666667\n1000,254.666666666667\n1000,232\n1000,256\n1000,248\n1000,250\n1000,252\n1000,253.333333333333\n1000,258.666666666667\n1000,259\n1000,270\n1000,278\n1000,267\n995,278\n990,303\n960,308\n938.333333333333,303.666666666667\n870,292\n1000,285\n1000,258\n1000,263\n1000,259.666666666667\n1000,259.333333333333\n1000,261.2\n1000,258.8\n1000,260.666666666667\n1000,259.666666666667\n1000,252\n1000,256.8\n1000,269\n1000,253\n1000,259\n1000,264\n1000,264\n1000,266.285714285714\n1000,259\n1000,274\n997,279.6\n955,274\n983.75,300.5\n930,338\n872.5,310\n1000,275\n1000,259.333333333333\n1000,272\n1000,270\n1000,256\n1000,258.5\n1000,258.666666666667\n1000,253.333333333333\n1000,252.8\n1000,252.666666666667\n1000,257\n1000,250\n1000,252.571428571429\n1000,252\n1000,259\n1000,264\n1000,278\n998.75,274\n992.5,269\n892.5,280.666666666667\n975,300\n878.75,288\n839.166666666667,302.666666666667\n858.333333333333,323.666666666667\n1000,275.666666666667\n1000,268\n1000,268\n1000,258\n1000,261\n1000,255.333333333333\n1000,252\n1000,270\n1000,264\n1000,256.8\n1000,244\n1000,256.857142857143\n1000,269\n1000,262.4\n996.666666666667,266.666666666667\n1000,265\n903.75,270.5\n906.666666666667,272.666666666667\n846.25,275\n897.5,278\n855,310\n836.666666666667,306.333333333333\n1000,271\n1000,259.5\n1000,254.666666666667\n1000,261\n1000,265.333333333333\n1000,253\n1000,253.5\n1000,264.666666666667\n1000,258\n1000,250\n1000,234\n1000,255.666666666667\n1000,252.5\n1000,256\n1000,254\n997.5,266.333333333333\n980,260.666666666667\n905,264.666666666667\n815,270\n892.5,293\n947.5,297\n927.5,306\n911.428571428571,311.714285714286\n805,325\n1000,275.6\n1000,272\n1000,266.4\n1000,256.333333333333\n1000,262.5\n1000,254.5\n1000,255.333333333333\n1000,255.5\n1000,258.8\n1000,250\n1000,255.142857142857\n1000,258.8\n1000,266\n1000,248\n997.5,260.5\n946.25,271\n850.833333333333,267.333333333333\n859.166666666667,276.333333333333\n895,271\n955,285\n936,300\n946.666666666667,290\n1000,267.6\n1000,278\n1000,258.4\n1000,259.2\n1000,259.333333333333\n1000,261.2\n1000,268\n1000,258.4\n1000,254.4\n1000,256\n1000,260\n1000,261.333333333333\n1000,255.333333333333\n1000,258.8\n1000,264\n975,276\n992.5,275.5\n906.666666666667,269.333333333333\n986.666666666667,273.333333333333\n997.5,288\n978.333333333333,290\n990,305\n975,315\n1000,271.5\n1000,256.857142857143\n1000,259\n1000,256.5\n1000,255.714285714286\n1000,252\n1000,263.333333333333\n1000,256.666666666667\n1000,254.333333333333\n1000,252\n1000,259\n1000,250.5\n999,264.8\n957.5,275\n958.333333333333,256.666666666667\n1000,262.666666666667\n1000,273.333333333333\n1000,274\n997.5,272\n997.5,283.5\n990,288\n966.666666666667,320\n1000,275.6\n1000,269.5\n1000,267.142857142857\n1000,255.5\n1000,260\n1000,256\n1000,249.333333333333\n1000,255.5\n1000,251.333333333333\n1000,260\n1000,253.333333333333\n1000,257\n1000,258.666666666667\n997.5,272\n943.333333333333,257.333333333333\n995,251\n1000,263.4\n1000,270\n1000,272\n995,290\n990,282\n998.333333333333,292\n995,298\n1000,262\n1000,259\n1000,262\n1000,268\n1000,256.4\n1000,250\n1000,260.666666666667\n1000,254.8\n1000,252\n1000,260.8\n1000,253.333333333333\n1000,254.8\n998.333333333333,257.333333333333\n1000,261.5\n985.833333333333,257\n983.75,256.5\n997.5,255.5\n1000,264\n1000,273.5\n1000,279\n1000,288.4\n1000,285.428571428571\n1000,309\n1000,311\n1000,262.571428571429\n1000,266.285714285714\n1000,261\n1000,258\n1000,246\n1000,260\n1000,249.333333333333\n1000,257\n1000,262.333333333333\n1000,258\n1000,244\n1000,264\n1000,259.6\n1000,252\n960,272\n1000,258.666666666667\n1000,256\n1000,262\n1000,282.5\n1000,289\n1000,289.5\n1000,289.6\n998.75,297.5\n1000,271\n1000,258\n1000,260\n1000,255.5\n1000,258\n1000,255.333333333333\n1000,257\n1000,254.5\n1000,260\n1000,259\n1000,261\n1000,257.333333333333\n1000,257.6\n997.5,266\n937.5,260\n995,248\n1000,276.666666666667\n1000,281\n1000,261\n1000,275.333333333333\n1000,285\n1000,296.4\n1000,306\n983.75,304\n1000,264.666666666667\n1000,270\n1000,256.666666666667\n1000,262.666666666667\n1000,261.333333333333\n998,262\n1000,252.4\n1000,249.666666666667\n1000,251.333333333333\n1000,253\n1000,249.5\n1000,264\n998.333333333333,250\n1000,257\n995,251\n1000,252\n1000,271.333333333333\n1000,279.5\n1000,272\n1000,296.666666666667\n1000,279.5\n1000,282\n995,310.666666666667\n948.333333333333,298.666666666667\n1000,266\n1000,266\n1000,260\n1000,258\n998.75,257.5\n1000,256.4\n1000,252.666666666667\n996.666666666667,251.333333333333\n1000,267\n1000,250\n1000,256\n995,254.5\n988.333333333333,252.666666666667\n1000,264.666666666667\n1000,267.6\n1000,260.8\n1000,265.6\n1000,277.5\n1000,270\n1000,294\n1000,279.2\n1000,303\n991.666666666667,292\n950,300\n1000,272.5\n1000,258\n955,269\n1000,256\n972,256.4\n1000,250\n940,255.333333333333\n892.5,257.5\n975,248\n1000,253.5\n1000,250\n1000,257.75\n1000,261.333333333333\n1000,273\n1000,265\n1000,272\n1000,269\n1000,274\n1000,290\n1000,300\n998.333333333333,301.333333333333\n995,321\n1000,266.666666666667\n1000,266\n1000,266\n902.5,263\n787.5,259\n821.666666666667,257.333333333333\n978,250.8\n998.75,256.5\n997.5,248\n963,250\n926.666666666667,252.666666666667\n977.142857142857,250.857142857143\n997.5,250\n997.5,258.5\n1000,269.333333333333\n1000,272\n999.5,261.4\n1000,260.5\n1000,274.5\n1000,270.666666666667\n1000,277\n1000,304\n998.571428571429,298.571428571429\n998.333333333333,312.666666666667\n998.75,267\n1000,265.333333333333\n970,259.333333333333\n735,248.5\n965,266\n989,257.6\n998,257.2\n1000,255.5\n1000,256.285714285714\n983,254.4\n951.25,249.5\n958.333333333333,252\n993.333333333333,262\n996.666666666667,261.666666666667\n1000,260\n1000,266.8\n995,263.142857142857\n1000,272\n1000,264\n1000,273.333333333333\n1000,290.666666666667\n1000,302\n1000,292.5\n1000,302.8\n980,266\n820,265.333333333333\n801.666666666667,255.333333333333\n786.25,249\n990,254.857142857143\n1000,252\n1000,244\n1000,252\n999,249.6\n990,261\n997.5,254\n974,251.6\n987.5,261\n996.25,263.5\n1000,268.666666666667\n1000,262.666666666667\n993.333333333333,276\n1000,277.333333333333\n1000,258.666666666667\n1000,273.6\n1000,286.666666666667\n1000,298.5\n1000,288.666666666667\n1000,300\n780,260\n715,249\n660,247.5\n1000,248\n995,254\n995,258.8\n1000,254\n1000,249.6\n995,256.666666666667\n989,259.6\n988.333333333333,250.666666666667\n983.333333333333,249.333333333333\n1000,263\n1000,248\n1000,270.5\n1000,269\n1000,282\n1000,283\n1000,292.666666666667\n1000,292\n1000,299.2\n1000,327.333333333333\n665,258\n748.333333333333,252\n916.666666666667,250\n1000,256\n992,260.4\n1000,248.666666666667\n1000,252.666666666667\n1000,246\n1000,255.666666666667\n985.833333333333,256.666666666667\n958.333333333333,246.666666666667\n957.5,264\n992.5,257\n998.75,255\n1000,268\n1000,254\n1000,269.333333333333\n1000,275\n1000,275\n1000,258\n1000,279.111111111111\n1000,292\n1000,292.5\n1000,321.333333333333\n956.428571428571,264.857142857143\n905,262.666666666667\n997.5,254.666666666667\n991.666666666667,258\n992.5,264\n1000,254.8\n1000,251\n1000,265.6\n1000,260\n977.5,248.5\n943.75,257.5\n960,250\n1000,258.333333333333\n1000,271.5\n1000,266\n1000,271\n1000,275\n1000,269\n1000,302\n1000,273\n1000,292.5\n1000,300.5\n1000,310\n992.5,257\n989,257.2\n998.333333333333,256.666666666667\n960,254\n983,256\n1000,252\n1000,250.666666666667\n1000,253.2\n1000,259.5\n995,254.666666666667\n973.75,251\n975,246.666666666667\n999,251.2\n1000,269\n1000,272\n1000,273.333333333333\n1000,255\n1000,276\n1000,278.571428571429\n1000,279.666666666667\n1000,295\n1000,296\n1000,308.8\n1000,338\n992.5,268\n990,256\n990,253\n972.5,261.5\n982.5,258.666666666667\n1000,258\n1000,268\n1000,250.4\n1000,254\n995,251.333333333333\n995,246.666666666667\n990,268\n1000,258.666666666667\n1000,259.2\n1000,264.4\n1000,270.8\n1000,267.142857142857\n1000,273.333333333333\n1000,281.5\n1000,279.428571428571\n1000,282\n1000,298.4\n1000,297.333333333333\n970,261.2\n995,260\n995,256\n956.666666666667,257.333333333333\n976.666666666667,260\n983.75,268.5\n998.333333333333,262\n1000,258\n1000,266\n998.333333333333,250\n988.333333333333,258\n1000,258.333333333333\n1000,258.5\n1000,266\n1000,268\n1000,261\n1000,263.333333333333\n1000,286.666666666667\n1000,280.5\n1000,288\n1000,281.333333333333\n1000,292.5\n1000,293\n1000,288"
    },
    {
      "name": "scale/x",
      "format": {
        "type": "csv",
        "parse": {
          "domain": "number"
        }
      },
      "values": "\"domain\"\n643\n1017"
    },
    {
      "name": "scale/y",
      "format": {
        "type": "csv",
        "parse": {
          "domain": "number"
        }
      },
      "values": "\"domain\"\n226.7\n343.3"
    }
  ],
  "scales": [
    {
      "name": "x",
      "domain": {
        "data": "scale/x",
        "field": "data.domain"
      },
      "zero": false,
      "nice": false,
      "clamp": false,
      "range": "width"
    },
    {
      "name": "y",
      "domain": {
        "data": "scale/y",
        "field": "data.domain"
      },
      "zero": false,
      "nice": false,
      "clamp": false,
      "range": "height"
    }
  ],
  "marks": [
    {
      "type": "symbol",
      "properties": {
        "update": {
          "fill": {
            "value": "#000000"
          },
          "size": {
            "value": 50
          },
          "x": {
            "scale": "x",
            "field": "data.pressure"
          },
          "y": {
            "scale": "y",
            "field": "data.ozone"
          }
        },
        "ggvis": {
          "data": {
            "value": ".0"
          }
        }
      },
      "from": {
        "data": ".0"
      }
    }
  ],
  "legends": [],
  "axes": [
    {
      "type": "x",
      "scale": "x",
      "orient": "bottom",
      "layer": "back",
      "grid": true,
      "title": "pressure"
    },
    {
      "type": "y",
      "scale": "y",
      "orient": "left",
      "layer": "back",
      "grid": true,
      "title": "ozone"
    }
  ],
  "padding": null,
  "ggvis_opts": {
    "keep_aspect": false,
    "resizable": true,
    "padding": {},
    "duration": 250,
    "renderer": "svg",
    "hover_duration": 0,
    "width": 672,
    "height": 480
  },
  "handlers": null
};
ggvis.getPlot("plot_id893835749").parseSpec(plot_id893835749_spec);
</script>
<!--/html_preserve-->
Plot temp vs ozone (ggvis)
--------------------------

``` r
means %>% 
  ggvis(x = ~temp, y = ~ozone) %>%
  layer_points()
```

<!--html_preserve-->

<nav class="ggvis-control"> <a class="ggvis-dropdown-toggle" title="Controls" onclick="return false;"></a>
<ul class="ggvis-dropdown">
<li>
Renderer: <a id="plot_id103628272_renderer_svg" class="ggvis-renderer-button" onclick="return false;" data-plot-id="plot_id103628272" data-renderer="svg">SVG</a> | <a id="plot_id103628272_renderer_canvas" class="ggvis-renderer-button" onclick="return false;" data-plot-id="plot_id103628272" data-renderer="canvas">Canvas</a>
</li>
<li>
<a id="plot_id103628272_download" class="ggvis-download" data-plot-id="plot_id103628272">Download</a>
</li>
</ul>
</nav>

<script type="text/javascript">
var plot_id103628272_spec = {
  "data": [
    {
      "name": ".0",
      "format": {
        "type": "csv",
        "parse": {
          "temp": "number",
          "ozone": "number"
        }
      },
      "values": "\"temp\",\"ozone\"\n296.133333333333,269.333333333333\n295.725,268.5\n298.05,248\n296,265\n296.88,260.8\n296.9,262\n299.5,250.666666666667\n298.433333333333,254.666666666667\n301,232\n296.933333333333,256\n297.8,248\n298.75,250\n300.5,252\n301.266666666667,253.333333333333\n300.833333333333,258.666666666667\n299.75,259\n301.9,270\n296.2,278\n298.7,267\n298.55,278\n290.95,303\n302.8,308\n292.1,303.666666666667\n297.1,292\n294.55,285\n297.066666666667,258\n296,263\n297.433333333333,259.666666666667\n297.2,259.333333333333\n297.1,261.2\n298.26,258.8\n298.433333333333,260.666666666667\n296.766666666667,259.666666666667\n298.45,252\n299.42,256.8\n300.1,269\n300.625,253\n300.55,259\n303.2,264\n302.3,264\n300.128571428571,266.285714285714\n297.4,259\n304.5,274\n301.48,279.6\n289.3,274\n295.125,300.5\n294.05,338\n290.95,310\n295.15,275\n295.833333333333,259.333333333333\n295.5,272\n295.5,270\n297.825,256\n298.075,258.5\n298.6,258.666666666667\n300.066666666667,253.333333333333\n298.34,252.8\n297.8,252.666666666667\n300.3,257\n300.75,250\n300.457142857143,252.571428571429\n301.3,252\n300.075,259\n301.566666666667,264\n298.3,278\n300.475,274\n300.95,269\n294.816666666667,280.666666666667\n296.2,300\n288.975,288\n281.95,302.666666666667\n289.6,323.666666666667\n294.266666666667,275.666666666667\n295.6,268\n295.5,268\n298.566666666667,258\n298.05,261\n298.3,255.333333333333\n300.5,252\n296,270\n297.85,264\n299.42,256.8\n298.7,244\n300.914285714286,256.857142857143\n302.1,269\n301.58,262.4\n300.366666666667,266.666666666667\n302.2,265\n298.275,270.5\n295,272.666666666667\n293.725,275\n299.4,278\n285.6,310\n283.733333333333,306.333333333333\n295.5,271\n294.7,259.5\n295.666666666667,254.666666666667\n295.75,261\n295.2,265.333333333333\n300.5,253\n298.7,253.5\n297.966666666667,264.666666666667\n295.5,258\n299.933333333333,250\n301.4,234\n300.016666666667,255.666666666667\n300.65,252.5\n301.525,256\n301.425,254\n302.4,266.333333333333\n299.2,260.666666666667\n292.833333333333,264.666666666667\n290.2,270\n295.55,293\n300.1,297\n292.85,306\n287.7,311.714285714286\n276.9,325\n293.52,275.6\n294.266666666667,272\n294.76,266.4\n296.983333333333,256.333333333333\n295.725,262.5\n297.625,254.5\n297.333333333333,255.333333333333\n299.175,255.5\n297.64,258.8\n300.5,250\n300.528571428571,255.142857142857\n301.34,258.8\n299.2,266\n301,248\n302.075,260.5\n299.85,271\n292.316666666667,267.333333333333\n293.233333333333,276.333333333333\n293.75,271\n295.966666666667,285\n294.72,300\n294.166666666667,290\n295.12,267.6\n291.95,278\n295.72,258.4\n295.4,259.2\n296.5,259.333333333333\n296.26,261.2\n294.6,268\n297.16,258.4\n298.88,254.4\n299.16,256\n299.65,260\n300.533333333333,261.333333333333\n301.4,255.333333333333\n302.24,258.8\n302.166666666667,264\n301.4,276\n303,275.5\n296.366666666667,269.333333333333\n297.3,273.333333333333\n303.85,288\n295.566666666667,290\n288.5,305\n293,315\n294.45,271.5\n295.228571428571,256.857142857143\n297.15,259\n297.4,256.5\n298.042857142857,255.714285714286\n301,252\n297.966666666667,263.333333333333\n299.8,256.666666666667\n299.1,254.333333333333\n300.75,252\n300.5,259\n301.1,250.5\n301.86,264.8\n298.5,275\n298.433333333333,256.666666666667\n298.266666666667,262.666666666667\n299.266666666667,273.333333333333\n300.95,274\n302.3,272\n300.025,283.5\n285.2,288\n290.866666666667,320\n293.02,275.6\n293.15,269.5\n294.1,267.142857142857\n295.95,255.5\n295.5,260\n298.95,256\n299.766666666667,249.333333333333\n298.05,255.5\n300.533333333333,251.333333333333\n299.033333333333,260\n300.566666666667,253.333333333333\n301.4,257\n301.433333333333,258.666666666667\n302.75,272\n297.533333333333,257.333333333333\n298.25,251\n299.99,263.4\n295.75,270\n302.3,272\n302.8,290\n290.2,282\n298.433333333333,292\n291.1,298\n295.75,262\n294.3,259\n294.55,262\n295.25,268\n297.34,256.4\n300.1,250\n297.066666666667,260.666666666667\n298.08,254.8\n300.3,252\n297.72,260.8\n298.6,253.333333333333\n301.26,254.8\n300.666666666667,257.333333333333\n302.3,261.5\n301.7,257\n298.1,256.5\n298.375,255.5\n297.8,264\n300.1,273.5\n298.2,279\n295.7,288.4\n302.314285714286,285.428571428571\n287.7,309\n302.7,311\n293.871428571429,262.571428571429\n293.7,266.285714285714\n295.4,261\n296.08,258\n300.1,246\n296.975,260\n298.566666666667,249.333333333333\n297.216666666667,257\n297.5,262.333333333333\n297.6,258\n302.3,244\n298.7,264\n301.88,259.6\n300.55,252\n301.266666666667,272\n299.466666666667,258.666666666667\n299.15,256\n298,262\n299.95,282.5\n293.675,289\n296.65,289.5\n298.76,289.6\n294.225,297.5\n292.983333333333,271\n294.733333333333,258\n293.85,260\n297.425,255.5\n296.54,258\n295.966666666667,255.333333333333\n298.95,257\n298.7,254.5\n295.78,260\n297.925,259\n300.55,261\n301.566666666667,257.333333333333\n301.6,257.6\n302.2,266\n297.6,260\n298.95,248\n300.533333333333,276.666666666667\n304.3,281\n296.7,261\n297.3,275.333333333333\n292.45,285\n292.04,296.4\n292.366666666667,306\n286.375,304\n293.3,264.666666666667\n292.275,270\n294.9,256.666666666667\n295.95,262.666666666667\n296.4,261.333333333333\n296.18,262\n298.64,252.4\n298.583333333333,249.666666666667\n300.2,251.333333333333\n298.35,253\n300.2,249.5\n300.233333333333,264\n301.866666666667,250\n301.3625,257\n300.5,251\n300.5,252\n300.966666666667,271.333333333333\n302.275,279.5\n299.78,272\n301.666666666667,296.666666666667\n297.45,279.5\n290.975,282\n299.033333333333,310.666666666667\n285.566666666667,298.666666666667\n293.04,266\n291.533333333333,266\n293.94,260\n295.4,258\n295.525,257.5\n298.18,256.4\n296.133333333333,252.666666666667\n298.9,251.333333333333\n297.6,267\n299.5,250\n301.05,256\n300.85,254.5\n301.266666666667,252.666666666667\n301.433333333333,264.666666666667\n301.36,267.6\n300.8,260.8\n300.98,265.6\n303.375,277.5\n296.45,270\n302.375,294\n300.38,279.2\n294.35,303\n291.583333333333,292\n282.7,300\n292.8,272.5\n295.833333333333,258\n291.7,269\n293.6,256\n296.34,256.4\n297.4,250\n291,255.333333333333\n293.35,257.5\n296,248\n300.625,253.5\n302.033333333333,250\n300.875,257.75\n300.2,261.333333333333\n300.75,273\n300.95,265\n304.25,272\n299.15,269\n297.5,274\n297.75,290\n296.333333333333,300\n302.133333333333,301.333333333333\n297.8,321\n293,266.666666666667\n293.133333333333,266\n294.1,266\n294.25,263\n286.5,259\n291.433333333333,257.333333333333\n297.72,250.8\n300.075,256.5\n301.2,248\n298,250\n296.266666666667,252.666666666667\n298.985714285714,250.857142857143\n302.8,250\n301.425,258.5\n302.6,269.333333333333\n299.85,272\n299.85,261.4\n300.175,260.5\n301.975,274.5\n296.566666666667,270.666666666667\n295.7,277\n295.02,304\n292.614285714286,298.571428571429\n289.766666666667,312.666666666667\n294.7,267\n295.666666666667,265.333333333333\n295.183333333333,259.333333333333\n281.875,248.5\n296.9,266\n299.62,257.6\n301.32,257.2\n301.65,255.5\n301.214285714286,256.285714285714\n298.46,254.4\n297.55,249.5\n298.7,252\n302.633333333333,262\n302,261.666666666667\n300.52,260\n300.8,266.8\n301.271428571429,263.142857142857\n302.725,272\n301.4,264\n296.583333333333,273.333333333333\n296.266666666667,290.666666666667\n294.1,302\n292.225,292.5\n295.12,302.8\n292.966666666667,266\n292.166666666667,265.333333333333\n288.266666666667,255.333333333333\n286.6,249\n299.685714285714,254.857142857143\n301.533333333333,252\n300.1,244\n301.266666666667,252\n301.6,249.6\n299.05,261\n301.65,254\n300.32,251.6\n302.4,261\n302.875,263.5\n300.833333333333,268.666666666667\n301.3,262.666666666667\n301.7,276\n301.7,277.333333333333\n299.3,258.666666666667\n298.56,273.6\n295.033333333333,286.666666666667\n296.2,298.5\n293.866666666667,288.666666666667\n301,300\n283.9,260\n283.95,249\n280.225,247.5\n304,248\n301.175,254\n300.72,258.8\n299.2,254\n302.4,249.6\n300.4,256.666666666667\n301.14,259.6\n302.7,250.666666666667\n301.266666666667,249.333333333333\n301.9,263\n301.4,248\n300.725,270.5\n302.55,269\n301.9,282\n293.6,283\n298.533333333333,292.666666666667\n295.36,292\n295.16,299.2\n289.933333333333,327.333333333333\n279.9,258\n283.7,252\n293.866666666667,250\n301.65,256\n300.96,260.4\n302.333333333333,248.666666666667\n302,252.666666666667\n304.9,246\n302.366666666667,255.666666666667\n300.466666666667,256.666666666667\n297.2,246.666666666667\n297.15,264\n302.625,257\n301.3,255\n300.366666666667,268\n301,254\n301.566666666667,269.333333333333\n298.3,275\n296.4,275\n296,258\n294.033333333333,279.111111111111\n296.025,292\n292.1,292.5\n289.9,321.333333333333\n298.357142857143,264.857142857143\n292.766666666667,262.666666666667\n299.783333333333,254.666666666667\n300.666666666667,258\n300.05,264\n302.64,254.8\n302.95,251\n302.64,265.6\n302.64,260\n299.4,248.5\n296.75,257.5\n297.6,250\n300.066666666667,258.333333333333\n301.975,271.5\n301,266\n300.4,271\n299.625,275\n297.6,269\n297.8,302\n297.3,273\n295.675,292.5\n294.025,300.5\n293.5,310\n298.7,257\n302,257.2\n301.566666666667,256.666666666667\n299.6,254\n300.08,256\n302.6,252\n301.666666666667,250.666666666667\n302.82,253.2\n302.2,259.5\n301.4,254.666666666667\n301.975,251\n296.733333333333,246.666666666667\n300.26,251.2\n301.85,269\n302.8,272\n300.8,273.333333333333\n299.15,255\n299.1,276\n298.557142857143,278.571428571429\n298.1,279.666666666667\n292.2,295\n294.375,296\n293.14,308.8\n290.08,338\n298.05,268\n303.2,256\n301.65,253\n299.275,261.5\n300,258.666666666667\n302.725,258\n301.45,268\n302.24,250.4\n301.45,254\n299.766666666667,251.333333333333\n301.4,246.666666666667\n301.4,268\n301.433333333333,258.666666666667\n300.78,259.2\n300.6,264.4\n300.32,270.8\n299.371428571429,267.142857142857\n300.366666666667,273.333333333333\n298.4,281.5\n297.542857142857,279.428571428571\n297.9,282\n294.98,298.4\n296.166666666667,297.333333333333\n299.62,261.2\n301.85,260\n301.4,256\n299.433333333333,257.333333333333\n299.5,260\n301.2,268.5\n301.133333333333,262\n301.55,258\n302.133333333333,266\n299.766666666667,250\n300.666666666667,258\n301.266666666667,258.333333333333\n300.425,258.5\n299.85,266\n301.05,268\n301.2,261\n299.033333333333,263.333333333333\n300.966666666667,286.666666666667\n299.825,280.5\n301,288\n293.6,281.333333333333\n295.3,292.5\n297.6,293\n296.066666666667,288"
    },
    {
      "name": "scale/x",
      "format": {
        "type": "csv",
        "parse": {
          "domain": "number"
        }
      },
      "values": "\"domain\"\n275.5\n306.3"
    },
    {
      "name": "scale/y",
      "format": {
        "type": "csv",
        "parse": {
          "domain": "number"
        }
      },
      "values": "\"domain\"\n226.7\n343.3"
    }
  ],
  "scales": [
    {
      "name": "x",
      "domain": {
        "data": "scale/x",
        "field": "data.domain"
      },
      "zero": false,
      "nice": false,
      "clamp": false,
      "range": "width"
    },
    {
      "name": "y",
      "domain": {
        "data": "scale/y",
        "field": "data.domain"
      },
      "zero": false,
      "nice": false,
      "clamp": false,
      "range": "height"
    }
  ],
  "marks": [
    {
      "type": "symbol",
      "properties": {
        "update": {
          "fill": {
            "value": "#000000"
          },
          "size": {
            "value": 50
          },
          "x": {
            "scale": "x",
            "field": "data.temp"
          },
          "y": {
            "scale": "y",
            "field": "data.ozone"
          }
        },
        "ggvis": {
          "data": {
            "value": ".0"
          }
        }
      },
      "from": {
        "data": ".0"
      }
    }
  ],
  "legends": [],
  "axes": [
    {
      "type": "x",
      "scale": "x",
      "orient": "bottom",
      "layer": "back",
      "grid": true,
      "title": "temp"
    },
    {
      "type": "y",
      "scale": "y",
      "orient": "left",
      "layer": "back",
      "grid": true,
      "title": "ozone"
    }
  ],
  "padding": null,
  "ggvis_opts": {
    "keep_aspect": false,
    "resizable": true,
    "padding": {},
    "duration": 250,
    "renderer": "svg",
    "hover_duration": 0,
    "width": 672,
    "height": 480
  },
  "handlers": null
};
ggvis.getPlot("plot_id103628272").parseSpec(plot_id103628272_spec);
</script>
<!--/html_preserve-->
Model (Linear)
--------------

``` r
mod <- lm(ozone ~ temp, data = means)
summary(mod)
```

    ## 
    ## Call:
    ## lm(formula = ozone ~ temp, data = means)
    ## 
    ## Residuals:
    ##     Min      1Q  Median      3Q     Max 
    ## -49.458 -10.192  -3.984   8.036  64.336 
    ## 
    ## Coefficients:
    ##             Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept) 769.1271    46.8185   16.43   <2e-16 ***
    ## temp         -1.6850     0.1572  -10.72   <2e-16 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 15.41 on 559 degrees of freedom
    ## Multiple R-squared:  0.1705, Adjusted R-squared:  0.1691 
    ## F-statistic: 114.9 on 1 and 559 DF,  p-value: < 2.2e-16
